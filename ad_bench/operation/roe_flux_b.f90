!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.13 (r6666M) - 28 May 2018 09:28
!
!  Differentiation of roe_flux in reverse (adjoint) mode (with options with!SliceDeadControl with!SliceDeadInstrs):
!   gradient     of useful results: flux1 flux2 flux3 flux4 flux5
!   with respect to varying inputs: temp velx vely velz flux1 flux2
!                flux3 flux4 flux5 rho
!   RW status of diff variables: temp:out velx:out vely:out velz:out
!                flux1:in-out flux2:in-out flux3:in-out flux4:in-out
!                flux5:in-out rho:out
SUBROUTINE ROE_FLUX_B(rho, rhob, velx, velxb, vely, velyb, velz, velzb, &
& temp, tempb6, surfx, surfy, surfz, flux1, flux1b, flux2, flux2b, flux3&
& , flux3b, flux4, flux4b, flux5, flux5b, im, gh)
  IMPLICIT NONE
! -------------------------------------------------
  INTEGER, INTENT(IN) :: im, gh
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: rho
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: rhob
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: velx, vely, velz
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: velxb, velyb, velzb
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: temp
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: tempb6
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: surfx
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: surfy
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: surfz
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux1
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux1b
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux2
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux2b
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux3
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux3b
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux4
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux4b
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux5
  REAL*8, DIMENSION(1-gh:im+gh), INTENT(INOUT) :: flux5b
  INTEGER :: i
  REAL*8 :: sc1, sc2, sc3
  REAL*8 :: gam
  REAL*8 :: rgaz
  REAL*8 :: wfl1, wfl2, wfl3, wfl4, wfl5
  REAL*8 :: wfl1b, wfl2b, wfl3b, wfl4b, wfl5b
  REAL*8 :: wfr1, wfr2, wfr3, wfr4, wfr5
  REAL*8 :: wfr1b, wfr2b, wfr3b, wfr4b, wfr5b
  REAL*8 :: gam1, gam1_1
  REAL*8 :: invsn
  REAL*8 :: rp, up, vp, wp, pp, rm, um, vm, wm, pm
  REAL*8 :: ppb, pmb
! to work with (roe mean)
  REAL*8 :: r, hm, hp
  REAL*8 :: hmb, hpb
! aerodynamic local values
  REAL*8 :: uu, vv, ww, ee, rr, hh, cc
! to work with (d1 computation)
  REAL*8 :: du, dv, dw, dvn, dd1, dd4, dd5
! idem
  REAL*8 :: df11, df12, df13, df14, df15
! idem
  REAL*8 :: df451, df452, df453, df454, df455
  REAL*8 :: nx, ny, nz, sn, vn
! small = pctrad% of spectral radius
  REAL*8 :: small
  REAL*8 :: aa1, aa4, aa5
  REAL*8 :: fcdx1, fcdx2, fcdx3, fcdx4, fcdx5, fcdx6
  REAL*8 :: fcdx1b, fcdx2b, fcdx3b, fcdx4b, fcdx5b
! flux densities
  REAL*8 :: fcdy1, fcdy2, fcdy3, fcdy4, fcdy5, fcdy6
  REAL*8 :: fcdy1b, fcdy2b, fcdy3b, fcdy4b, fcdy5b
  REAL*8 :: fcdz1, fcdz2, fcdz3, fcdz4, fcdz5, fcdz6
  REAL*8 :: fcdz1b, fcdz2b, fcdz3b, fcdz4b, fcdz5b
  REAL*8 :: flc1, flc2, flc3, flc4, flc5, flc6
  REAL*8 :: flc1b, flc2b, flc3b, flc4b, flc5b
  REAL*8 :: fld1, fld2, fld3, fld4, fld5, fld6
  INTRINSIC SQRT
  INTRINSIC MAX
  REAL*8 :: max1
  REAL*8 :: tempb
  REAL*8 :: tempb0
  REAL*8 :: tempb1
  REAL*8 :: tempb2
  REAL*8 :: tempb3
  REAL*8 :: tempb4
  REAL*8 :: tempb5
! -------------------------------------------------
  gam = 1.4
  gam1 = gam - 1.
  gam1_1 = 1./gam1
  rgaz = 237.
  tempb6 = 0.0_8
  velxb = 0.0_8
  velyb = 0.0_8
  velzb = 0.0_8
  rhob = 0.0_8
  DO i=1,im
    sc1 = surfx(i)
    sc2 = surfy(i)
    sc3 = surfz(i)
    sn = SQRT(sc1*sc1 + sc2*sc2 + sc3*sc3)
    IF (sn .LT. 1.d-32) THEN
      max1 = 1.d-32
    ELSE
      max1 = sn
    END IF
    invsn = 1.d0/max1
    nx = sc1*invsn
    ny = sc2*invsn
    nz = sc3*invsn
    wfl1 = rho(i-1)
    wfr1 = rho(i)
    wfl2 = velx(i-1)
    wfr2 = velx(i)
    wfl3 = vely(i-1)
    wfr3 = vely(i)
    wfl4 = velz(i-1)
    wfr4 = velz(i)
    wfl5 = temp(i-1)
    wfr5 = temp(i)
    hm = gam*gam1_1*wfl5*rgaz + 0.5d0*(wfl2*wfl2+wfl3*wfl3+wfl4*wfl4)
    hp = gam*gam1_1*wfr5*rgaz + 0.5d0*(wfr2*wfr2+wfr3*wfr3+wfr4*wfr4)
    flc5b = flux5b(i)
    ! flux5b(i) = 0.0_8
    flc4b = flux4b(i)
    ! flux4b(i) = 0.0_8
    flc3b = flux3b(i)
    ! flux3b(i) = 0.0_8
    flc2b = flux2b(i)
    ! flux2b(i) = 0.0_8
    flc1b = flux1b(i)
    ! flux1b(i) = 0.0_8
    tempb = sn*0.5d0*flc5b
    fcdx5b = nx*tempb
    fcdy5b = ny*tempb
    fcdz5b = nz*tempb
    tempb0 = sn*0.5d0*flc4b
    fcdx4b = nx*tempb0
    fcdy4b = ny*tempb0
    fcdz4b = nz*tempb0
    tempb1 = sn*0.5d0*flc3b
    fcdx3b = nx*tempb1
    fcdy3b = ny*tempb1
    fcdz3b = fcdy4b + nz*tempb1
    tempb2 = sn*0.5d0*flc2b
    fcdx2b = nx*tempb2
    fcdy2b = fcdx3b + ny*tempb2
    fcdz2b = fcdx4b + nz*tempb2
    tempb3 = sn*0.5d0*flc1b
    fcdx1b = nx*tempb3
    fcdy1b = ny*tempb3
    fcdz1b = nz*tempb3
    hpb = wfr3*wfr1*fcdy5b + wfr2*wfr1*fcdx5b + wfr4*wfr1*fcdz5b
    hmb = wfl3*wfl1*fcdy5b + wfl2*wfl1*fcdx5b + wfl4*wfl1*fcdz5b
    ppb = fcdy3b + fcdx2b + fcdz4b
    wfr1b = hp*wfr3*fcdy5b + wfr4**2*fcdz4b + wfr3**2*fcdy3b + wfr3*wfr2&
&     *fcdy2b + wfr4*fcdz1b + wfr2*fcdx1b + rgaz*wfr5*ppb + wfr3*fcdy1b &
&     + wfr2**2*fcdx2b + wfr4*wfr2*fcdz2b + wfr4*wfr3*fcdz3b + hp*wfr2*&
&     fcdx5b + hp*wfr4*fcdz5b
    pmb = fcdy3b + fcdx2b + fcdz4b
    wfl1b = hm*wfl3*fcdy5b + wfl4**2*fcdz4b + wfl3**2*fcdy3b + wfl3*wfl2&
&     *fcdy2b + wfl4*fcdz1b + wfl2*fcdx1b + rgaz*wfl5*pmb + wfl3*fcdy1b &
&     + wfl2**2*fcdx2b + wfl4*wfl2*fcdz2b + wfl4*wfl3*fcdz3b + hm*wfl2*&
&     fcdx5b + hm*wfl4*fcdz5b
    tempb4 = 0.5d0*hpb
    wfr4b = wfr1*2*wfr4*fcdz4b + wfr1*wfr2*fcdz2b + 2*wfr4*tempb4 + wfr1&
&     *fcdz1b + wfr1*wfr3*fcdz3b + hp*wfr1*fcdz5b
    wfr3b = wfr4*wfr1*fcdz3b + wfr1*wfr2*fcdy2b + 2*wfr3*tempb4 + wfr1*&
&     fcdy1b + wfr1*2*wfr3*fcdy3b + hp*wfr1*fcdy5b
    wfr2b = wfr4*wfr1*fcdz2b + wfr1*2*wfr2*fcdx2b + 2*wfr2*tempb4 + wfr1&
&     *fcdx1b + wfr3*wfr1*fcdy2b + hp*wfr1*fcdx5b
    wfr5b = rgaz*wfr1*ppb + gam*gam1_1*rgaz*hpb
    tempb5 = 0.5d0*hmb
    wfl4b = wfl1*2*wfl4*fcdz4b + wfl1*wfl2*fcdz2b + 2*wfl4*tempb5 + wfl1&
&     *fcdz1b + wfl1*wfl3*fcdz3b + hm*wfl1*fcdz5b
    wfl3b = wfl4*wfl1*fcdz3b + wfl1*wfl2*fcdy2b + 2*wfl3*tempb5 + wfl1*&
&     fcdy1b + wfl1*2*wfl3*fcdy3b + hm*wfl1*fcdy5b
    wfl2b = wfl4*wfl1*fcdz2b + wfl1*2*wfl2*fcdx2b + 2*wfl2*tempb5 + wfl1&
&     *fcdx1b + wfl3*wfl1*fcdy2b + hm*wfl1*fcdx5b
    wfl5b = rgaz*wfl1*pmb + gam*gam1_1*rgaz*hmb
    tempb6(i) = tempb6(i) + wfr5b
    tempb6(i-1) = tempb6(i-1) + wfl5b
    velzb(i) = velzb(i) + wfr4b
    velzb(i-1) = velzb(i-1) + wfl4b
    velyb(i) = velyb(i) + wfr3b
    velyb(i-1) = velyb(i-1) + wfl3b
    velxb(i) = velxb(i) + wfr2b
    velxb(i-1) = velxb(i-1) + wfl2b
    rhob(i) = rhob(i) + wfr1b
    rhob(i-1) = rhob(i-1) + wfl1b
  END DO
END SUBROUTINE ROE_FLUX_B
